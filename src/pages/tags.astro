---
import BaseLayout from '../layouts/BaseLayout.astro';
import { Image } from 'astro:assets';
const pageTitle = "Tags Page";
//
import { getCollection } from "astro:content";
const allPosts = await getCollection('blog');
const tags = [...new Set([].concat.apply([], allPosts.flatMap(post => post.data.tags)))]
const tagCounts = {};
allPosts.forEach(post => {
  post.data.tags.forEach(tag => {
    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
  });
});
const { page } = Astro.props
//
---
<BaseLayout pageTitle={pageTitle}>
  <div class="relative">
        <!-- Gradients -->
        <div aria-hidden="true" class="flex absolute -top-48 start-0 -z-[1]">
          <div class="bg-purple-200 opacity-30 blur-3xl w-[1036px] h-[600px] dark:bg-purple-900 dark:opacity-20"></div>
          <div class="bg-slate-200 opacity-90 blur-3xl w-[577px] h-[300px] transform translate-y-32 dark:bg-slate-800/60"></div>
      </div>
      <!-- End Gradients -->
    <div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 md:py-14 lg:py-20 mx-auto">
      <ul class="tag-list">
        {tags.flatMap((tag) => (
            <li class="tag"><a  href={`/tags/${tag}/`} title={`View posts tagged under "${tag.charAt(0).toUpperCase() + tag.slice(1) }"`}>{tag.charAt(0).toUpperCase() + tag.slice(1) }</a> <span class="hidden lg:inline text-[9px] sub">({tagCounts[tag] || 0})</span></li>
        ))}
    </ul>
    </div>
  </div>
</BaseLayout>
<style>
  .tag-list {
      @apply list-none flex gap-2 flex-wrap
  }
  .tag {
      @apply inline-block text-xl px-4 py-1 rounded-full text-purple-600 bg-purple-50 dark:bg-purple-200 dark:text-purple-800 hover:bg-purple-600 hover:text-purple-300 dark:hover:bg-purple-800 dark:hover:text-purple-200
  }
</style>