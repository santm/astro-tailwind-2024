---
import Container from "../../components/Container.astro";
import BaseLayout from '../../layouts/BaseLayout.astro';
import BlogListing from '../../components/BlogListing.astro';
import { getCollection } from "astro:content";
export async function getStaticPaths({ }) {
  const allPosts = await getCollection('blog')
  const allTags = new Set()
  allPosts.flatMap(post => {
      post.data.tags && post.data.tags.flatMap(tag => allTags.add(tag.toLowerCase()))
  })

  return Array.from(allTags).flatMap((tag) => {
    const filteredPosts = allPosts.filter((post) => post.data.tags.includes(tag))
    return {
      params: { tag },
      props: {
          pages: filteredPosts
      }
    };
  });
}

const { pages } = Astro.props
const { tag } = Astro.params
---
<BaseLayout pageTitle={tag}>

            <div data-pagefind-ignore>
                <h1 class="pb-4 text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500">{`Posts by Tag: ${tag.charAt(0).toUpperCase() + tag.slice(1)}`}</h1>
                <p class="prose md:prose-lg lg:prose-xl dark:prose-invert max-w-none">Collection of articles that may not be anything, but offer an effort by us to remember something and reflect upn and a dash of very emeotions.</p>
                <li class="tag"><a  href={`/tags/${tag.toLowerCase()}/`} title={`View posts tagged under "${tag.charAt(0).toUpperCase() + tag.slice(1) }"`}>{tag.charAt(0).toUpperCase() + tag.slice(1) }</a> </li>
                <BlogListing posts={pages} />
            </div>
              


</BaseLayout>
<style>
    .tag {
        @apply inline-block text-xl px-4 py-1 rounded-full text-purple-600 bg-purple-50 dark:bg-purple-200 dark:text-purple-800 hover:bg-purple-600 hover:text-purple-300 dark:hover:bg-purple-800 dark:hover:text-purple-200
    }
</style>
