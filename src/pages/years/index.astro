---
import BaseLayout from "../../layouts/BaseLayout.astro";
const pageTitle = "Year wise listing";
import { getCollection } from "astro:content";
const allPosts = await getCollection("blog");
const postYears = [
  ...new Set(
    [].concat.apply(
      [],
      allPosts.flatMap((post) => post.data.pubDate.getFullYear())
    )
  ),
];

const yearPostCount = {};
allPosts.forEach((post) => {
  const year = post.data.pubDate.getFullYear();
  yearPostCount[year] = (yearPostCount[year] || 0) + 1;
});
---

<BaseLayout pageTitle={pageTitle}>
  <div class="p-4" data-pagefind-ignore>
    <h1 class="text-balance pb-4 text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500">{pageTitle}</h1>
    <ul class="tag-list">
      {
        postYears.flatMap((year) => (
          <li class="year">
            <>
              <a href={`/years/${year}/`} title={`View "${yearPostCount[year]}" posts for "${year}"`}>
                {year}
              </a>
              <span class="hidden lg:inline text-[9px] sub"> ({yearPostCount[year]})</span>
            </>{" "}
          </li>
        ))
      }
    </ul>
  </div>
</BaseLayout>
<style>
  .tag-list {
    @apply list-none flex gap-2 flex-wrap;
  }
  .year {
    @apply inline-block text-xl px-4 py-1 rounded-full text-purple-600 bg-purple-50 dark:bg-purple-200 dark:text-purple-800 hover:bg-purple-600 hover:text-purple-300 dark:hover:bg-purple-800 dark:hover:text-purple-200;
  }
</style>
