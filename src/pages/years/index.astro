---
import Container from "../../components/Container.astro";
import BaseLayout from '../../layouts/BaseLayout.astro';
const pageTitle = "Year wise listing";
import { getCollection } from "astro:content";
const allPosts = await getCollection("blog");
const postYears = [...new Set([].concat.apply([], allPosts.flatMap(post => post.data.pubDate.getFullYear())))]

const yearPostCount = {};
allPosts.forEach(post => {
  const year = post.data.pubDate.getFullYear();
  yearPostCount[year] = (yearPostCount[year] || 0) + 1;
});
---
<BaseLayout pageTitle={pageTitle}>
    <main class="space-y-40 mb-40" data-pagefind-ignore>
        <div class="relative" id="years">
            <div aria-hidden="true" class="absolute inset-0 grid grid-cols-2 -space-x-52 opacity-40 dark:opacity-20">
                <div class="blur-[106px] h-56 bg-gradient-to-br from-primary to-purple-400 dark:from-blue-700"></div>
                <div class="blur-[106px] h-32 bg-gradient-to-r from-cyan-400 to-sky-300 dark:to-indigo-600"></div>
            </div>
            <Container>
                <div class="relative pt-36 ml-auto">
                    <h1 class="pb-4 text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500">{pageTitle}</h1>
                    <ul class="tag-list">
                        {postYears.flatMap((year) => (
                            <li class="year"><a  href={`/years/${year}/`} title={`View "${ yearPostCount[year] }" posts for "${year}"`}>{year}</a><span class="hidden lg:inline text-[9px] sub"> ({ yearPostCount[year]})</span> </li>
                        ))}
                    </ul>
                </div>
               
            </Container>

        </div>
    </main>

</BaseLayout>
<style>
    .tag-list {
        @apply list-none flex gap-2 flex-wrap
    }
    .year {
        @apply inline-block text-xl px-4 py-1 rounded-full text-purple-600 bg-purple-50 dark:bg-purple-200 dark:text-purple-800 hover:bg-purple-600 hover:text-purple-300 dark:hover:bg-purple-800 dark:hover:text-purple-200
    }
</style>